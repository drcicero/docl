<!doctype html><html><head>
  <meta charset=utf-8>
  <title>Reference</title>
  <link href="style.css" rel="stylesheet" type="text/css"></meta>

</head><body>
  <div id=content>
<h1> Readable tostring</h1><p> provides the <code>repr</code> function below.
<pre class=run>repr&nbsp;<span class=operator>=</span>&nbsp;require&nbsp;<span class=string>"repr"</span></pre><pre class=success>nil</pre>
<div class=turnable>
  <input id=code-folder type=checkbox>
  <label for=code-folder>View source-code</label>
  <div><pre id=folded-code style=width:inherit>
<span class=comment>--- Readable tostring</span><br><span class=comment>-- provides the <span class=string>'repr'</span> function below.</span><br><span class=comment>--[[</span><br>repr&nbsp;<span class=operator>=</span>&nbsp;require&nbsp;<span class=string>"repr"</span><br><span class=operator>]</span><span class=operator>]</span><span class=comment>--@RUN</span><br><br><span class=keyword>local</span>&nbsp;M&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>{</span><span class=operator>}</span><br><br><span class=keyword>local</span>&nbsp;<span class=keyword>function</span>&nbsp;key_repr<span class=operator>(</span>value<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;type<span class=operator>(</span>value<span class=operator>)</span>&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"string"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;value:match<span class=operator>(</span><span class=string>"%l%w*"</span><span class=operator>)</span>&nbsp;and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;or&nbsp;<span class=string>"["</span>&nbsp;+&nbsp;M.repr<span class=operator>(</span>value<span class=operator>)</span>&nbsp;+&nbsp;<span class=string>"]"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;tostring<span class=operator>(</span>value<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><span class=comment>--- Generate a readable string out of any lua-value.</span><br><span class=comment>-- It is almost serialisation ;)</span><br><span class=comment>--</span><br><span class=comment>-- Examples:</span><br><span class=comment>--[[</span><br><span class=keyword>return</span>&nbsp;repr.repr<span class=operator>(</span>nil<span class=operator>)</span><br><span class=operator>]</span><span class=operator>]</span><span class=comment>--@EXPECT <span class=string>"nil"</span></span><br><span class=comment>--[[</span><br><span class=keyword>return</span>&nbsp;repr.repr<span class=operator>(</span>1<span class=operator>)</span><br><span class=operator>]</span><span class=operator>]</span><span class=comment>--@EXPECT <span class=string>"1"</span></span><br><span class=comment>--[[</span><br><span class=keyword>return</span>&nbsp;repr.repr&nbsp;<span class=string>"teststring"</span><br><span class=operator>]</span><span class=operator>]</span><span class=comment>--@EXPECT <span class=string>"$2;teststring$3;"</span></span><br><span class=comment>--[[</span><br><span class=keyword>return</span>&nbsp;repr.repr&nbsp;<span class=operator>{</span>1,&nbsp;2,&nbsp;b<span class=operator>=</span>7,&nbsp;3,&nbsp;a<span class=operator>=</span>6,<span class=operator>}</span><br><span class=operator>]</span><span class=operator>]</span><span class=comment>--@EXPECT <span class=string>"{1, 2, 3, a=6, b=7}"</span></span><br><span class=comment>--[[</span><br><span class=keyword>return</span>&nbsp;repr.repr<span class=operator>(</span><span class=keyword>function</span>&nbsp;<span class=operator>(</span><span class=operator>)</span>&nbsp;end<span class=operator>)</span><br><span class=operator>]</span><span class=operator>]</span><span class=comment>--@RUN</span><br><span class=keyword>function</span>&nbsp;M.repr<span class=operator>(</span>value<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;type<span class=operator>(</span>value<span class=operator>)</span>&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"table"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;t&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>{</span><span class=operator>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>for</span>&nbsp;k,v&nbsp;<span class=keyword>in</span>&nbsp;ipairs<span class=operator>(</span>value<span class=operator>)</span>&nbsp;<span class=keyword>do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t<span class=operator>[</span><span class=operator>#</span>t+1<span class=operator>]</span>&nbsp;<span class=operator>=</span>&nbsp;M.repr<span class=operator>(</span>v<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;len&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>#</span>t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>for</span>&nbsp;k,v&nbsp;<span class=keyword>in</span>&nbsp;pairs<span class=operator>(</span>value<span class=operator>)</span>&nbsp;<span class=keyword>do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;type<span class=operator>(</span>k<span class=operator>)</span>&nbsp;~<span class=operator>=</span>&nbsp;<span class=string>"number"</span>&nbsp;or&nbsp;k&nbsp;>&nbsp;len&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t<span class=operator>[</span><span class=operator>#</span>t+1<span class=operator>]</span>&nbsp;<span class=operator>=</span>&nbsp;key_repr<span class=operator>(</span>k<span class=operator>)</span>&nbsp;..<span class=string>"="</span>..&nbsp;M.repr<span class=operator>(</span>v<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table.sort<span class=operator>(</span>t<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;<span class=string>"{"</span>&nbsp;..&nbsp;table.concat<span class=operator>(</span>t,&nbsp;<span class=string>", "</span><span class=operator>)</span>&nbsp;..&nbsp;<span class=string>"}"</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>elseif</span>&nbsp;type<span class=operator>(</span>value<span class=operator>)</span>&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"string"</span>&nbsp;<span class=keyword>then</span><br><span class=comment>--        if value:find(<span class=string>"$1;n"</span>) == nil then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;<span class=operator>(</span><span class=string>"%q"</span><span class=operator>)</span>:format<span class=operator>(</span>value<span class=operator>)</span><br><span class=comment>--        else</span><br><span class=comment>--            return <span class=string>"[["</span> .. value .. <span class=string>"]]"</span></span><br><span class=comment>--        end</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;tostring<span class=operator>(</span>value<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><span class=keyword>return</span>&nbsp;M<br></pre></div></div><p><dl><dt id=M.repr><a href=#M.repr>M.repr (value)</a></dt>
<dd><p> Generate a readable string out of any lua-value.
 It is almost serialisation ;)</p><p> Examples:
<pre class=run><span class=keyword>return</span>&nbsp;repr.repr<span class=operator>(</span>nil<span class=operator>)</span></pre><pre class=success><span class=string>"nil"</span></pre>
<pre class=run><span class=keyword>return</span>&nbsp;repr.repr<span class=operator>(</span>1<span class=operator>)</span></pre><pre class=success><span class=string>"1"</span></pre>
<pre class=run><span class=keyword>return</span>&nbsp;repr.repr&nbsp;<span class=string>"teststring"</span></pre><pre class=success><span class=string>"<span class=escape>\"</span>teststring<span class=escape>\"</span>"</span></pre>
<pre class=run><span class=keyword>return</span>&nbsp;repr.repr&nbsp;<span class=operator>{</span>1,&nbsp;2,&nbsp;b<span class=operator>=</span>7,&nbsp;3,&nbsp;a<span class=operator>=</span>6,<span class=operator>}</span></pre><pre class=success><span class=string>"{1, 2, 3, a=6, b=7}"</span></pre>
<pre class=run><span class=keyword>return</span>&nbsp;repr.repr<span class=operator>(</span><span class=keyword>function</span>&nbsp;<span class=operator>(</span><span class=operator>)</span>&nbsp;end<span class=operator>)</span></pre><pre class=success><span class=string>"function: 0xa31100"</span></pre></p></dd></dl>
  </div><div id=navigation>
<a href=index.html>> Index</a><h2> Readable tostring</h2><li><a href=#M.repr>M.repr (value)</a></li>
  </div><footer style=margin-right>
    generated with docl
  </footer></body></html>