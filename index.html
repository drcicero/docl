<!doctype html><html><head>
  <meta charset=utf-8>
  <title>Reference</title>
  <link href="style.css" rel="stylesheet" type="text/css"></meta>

</head><body>
  <div id=content>
<h1> docl</h1><p> Document and test your Lua scripts with <code>docl</code>!</p><p> docl is available under a <a href=/docl/LICENSE.txt>MIT license</a>.</p><p><div class=turnable>
  <input id=code-folder type=checkbox>
  <label for=code-folder>View source-code</label>
  <div><pre id=folded-code style=width:inherit>
<span class=operator>#</span>!&nbsp;<span class=operator>/</span>usr<span class=operator>/</span>bin<span class=operator>/</span>env&nbsp;lua<br><br><span class=comment>--- docl</span><br><span class=comment>-- Document and test your Lua scripts with <span class=string>'docl'</span>!</span><br><span class=comment>--</span><br><span class=comment>-- docl is available under a &lt;a href=/docl/LICENSE.txt>MIT license&lt;/a>.</span><br><span class=comment>--</span><br><span class=comment>--- Usage</span><br><span class=comment>-- <span class=string>'"docl [-v] [-h] [-d OUTPUTDIR] [--lift LIFTFILE] FILES"'</span></span><br><span class=comment>--</span><br><span class=comment>-- Generate the documentation files. Creates files at</span><br><span class=comment>-- <span class=string>'OUTPUTDIR/path.to.file.html'</span> for every specified file and <span class=string>'index.html'</span></span><br><span class=comment>-- file, containing a summary.</span><br><span class=comment>--</span><br><span class=comment>-- For example the documentation of <span class=string>'src/plugins/vector.lua'</span> would be placed</span><br><span class=comment>-- at <span class=string>'docs/src.plugins.vector.lua.html'</span>.</span><br><span class=comment>--</span><br><span class=comment>-- The default OUTPUTDIR is <span class=string>'doc'</span>.</span><br><span class=comment>--</span><br><span class=comment>--</span><br><span class=comment>--- Options</span><br><span class=comment>-- <span class=string>'"-v"'</span></span><br><span class=comment>--    show version number</span><br><span class=comment>--</span><br><span class=comment>-- <span class=string>'"-h"'</span></span><br><span class=comment>--    show a short help</span><br><span class=comment>--</span><br><span class=comment>-- <span class=string>'"-d OUTPUTDIR"'</span></span><br><span class=comment>--</span><br><span class=comment>--    specify a directory for the html documentation files.</span><br><span class=comment>--    default is <span class=string>'doc'</span></span><br><span class=comment>--</span><br><span class=comment>-- <span class=string>'"--lift LIFTFILE"'</span></span><br><span class=comment>--</span><br><span class=comment>--    <span class=string>"lift"</span> a specific file. eg. show its documentation on the index page.</span><br><span class=comment>--    you probably want to do that with the main file.</span><br><span class=comment>--</span><br><span class=comment>--</span><br><span class=comment>--- Note</span><br><span class=comment>--  docl names the documentation of files relative to the working directory.</span><br><span class=comment>--</span><br><span class=comment>--  if all files to be documented are inside a specific directory, you</span><br><span class=comment>--  should <span class=string>'cd'</span> (change-directory) there, before invoking <span class=string>'docl'</span>.</span><br><span class=comment>--</span><br><span class=comment>--  For example if you are at <span class=string>'/home/james/'</span> and you call</span><br><span class=comment>--</span><br><span class=comment>--    <span class=string>'docl my-programs/my-app/src/lua/*.lua'</span></span><br><span class=comment>--</span><br><span class=comment>--  then docl will name the output files <span class=string>'my-programs.my-app.src.lua.*.lua.html'</span></span><br><span class=comment>--  (which is pretty dumb).</span><br><span class=comment>--</span><br><span class=comment>--  if you want them to be called only *.lua.html simply <span class=string>'cd'</span> (change the</span><br><span class=comment>--  directory) before invoking docl.</span><br><span class=comment>--</span><br><span class=comment>--    <span class=string>'cd /home/james/my-programs/my-app/src/lua; docl *.lua'</span></span><br><span class=comment>--</span><br><span class=comment>--  then docl will name the output files <span class=string>'*.lua.html'</span> which is much better.</span><br><span class=comment>--</span><br><span class=comment>--- Examples</span><br><span class=comment>-- Here are some usage examples:</span><br><span class=comment>--</span><br><span class=comment>-- <span class=string>'./docl *.lua'</span></span><br><span class=comment>--</span><br><span class=comment>-- document all .lua files in this directory</span><br><span class=comment>--</span><br><span class=comment>-- <span class=string>'./docl *.lua */*.lua'</span></span><br><span class=comment>--</span><br><span class=comment>-- document all .lua files in this directory and all subdirectories</span><br><span class=comment>-- (but not recursive!)</span><br><span class=comment>--</span><br><span class=comment>-- <span class=string>'./docl -d html-doc $1;$2;((find -name "*.lua"))'</span></span><br><span class=comment>--</span><br><span class=comment>-- recursively document all files ending in .lua and put output into <span class=string>'html-doc/'</span></span><br><span class=comment>--</span><br><br>help&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>[</span><span class=operator>[</span><br>NAME<br>&nbsp;&nbsp;docl&nbsp;-&nbsp;Document&nbsp;your&nbsp;Lua&nbsp;Scripts&nbsp;with&nbsp;DocL!<br><br>SYNOPSIS<br>&nbsp;&nbsp;docl&nbsp;<span class=operator>[</span>-v<span class=operator>]</span>&nbsp;<span class=operator>[</span>-h<span class=operator>]</span>&nbsp;<span class=operator>[</span>-d&nbsp;OUTPUTDIR<span class=operator>]</span>&nbsp;<span class=operator>[</span>-lift&nbsp;LIFTFILE<span class=operator>]</span>&nbsp;FILES<br><br>&nbsp;&nbsp;This&nbsp;will&nbsp;create&nbsp;the&nbsp;dir&nbsp;OUTPUTDIR&nbsp;<span class=operator>(</span>default&nbsp;is&nbsp;<span class=string>'doc/'</span><span class=operator>)</span>&nbsp;and&nbsp;<span class=keyword>for</span>&nbsp;every<br>&nbsp;&nbsp;supplied&nbsp;file&nbsp;a&nbsp;file&nbsp;<span class=string>'path.to.file.html'</span>&nbsp;.<br><br>OPTIONS<br>&nbsp;&nbsp;-v&nbsp;&nbsp;show&nbsp;version&nbsp;number<br>&nbsp;&nbsp;-h&nbsp;&nbsp;show&nbsp;this&nbsp;help<br>&nbsp;&nbsp;-d&nbsp;&lt;dir><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specify&nbsp;output&nbsp;directory<br>&nbsp;&nbsp;<span class=comment>--lift &lt;file></span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lift&nbsp;a&nbsp;specific&nbsp;file.&nbsp;eg.&nbsp;show&nbsp;its&nbsp;documentation&nbsp;on&nbsp;the&nbsp;index&nbsp;page.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;you&nbsp;probably&nbsp;want&nbsp;to&nbsp;<span class=keyword>do</span>&nbsp;that&nbsp;with&nbsp;the&nbsp;<span class=string>'main'</span>&nbsp;file.<br><br>NOTE<br>&nbsp;&nbsp;For&nbsp;more&nbsp;information&nbsp;please&nbsp;look&nbsp;at&nbsp;the&nbsp;docl&nbsp;generated&nbsp;HTML&nbsp;Documentation<br>&nbsp;&nbsp;at&nbsp;file:<span class=operator>/</span><span class=operator>/</span><span class=operator>]</span><span class=operator>]</span>&nbsp;..&nbsp;arg<span class=operator>[</span>0<span class=operator>]</span>&nbsp;..&nbsp;<span class=operator>[</span><span class=operator>[</span><span class=operator>/</span>html-doc<span class=operator>/</span>index.html.<br><span class=operator>]</span><span class=operator>]</span><br><br><span class=keyword>local</span>&nbsp;<span class=keyword>function</span>&nbsp;does_directory_exist<span class=operator>(</span>dir<span class=operator>)</span><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;f&nbsp;<span class=operator>=</span>&nbsp;io.open<span class=operator>(</span>dir&nbsp;..&nbsp;<span class=string>"/index.html"</span>,&nbsp;<span class=string>"r"</span><span class=operator>)</span><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;content&nbsp;<span class=operator>=</span>&nbsp;<span class=string>""</span><br>&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;f&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;<span class=operator>=</span>&nbsp;f:read<span class=operator>(</span><span class=string>"*a"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;f:close<span class=operator>(</span><span class=operator>)</span><br>&nbsp;&nbsp;<span class=keyword>end</span><br><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;f&nbsp;<span class=operator>=</span>&nbsp;io.open<span class=operator>(</span>dir&nbsp;..&nbsp;<span class=string>"/index.html"</span>,&nbsp;<span class=string>"w"</span><span class=operator>)</span><br>&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;not&nbsp;f&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"ERROR: the directory <span class=string>'" .. dir .. "'</span> does not exist."</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"  please create it by executing <span class=string>'mkdir " .. dir .. "'</span>"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;false<br><br>&nbsp;&nbsp;<span class=keyword>else</span>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;f:write<span class=operator>(</span>content<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;f:close<span class=operator>(</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;true<br>&nbsp;&nbsp;<span class=keyword>end</span><br><br><span class=keyword>end</span><br><br><br><span class=keyword>local</span>&nbsp;<span class=keyword>function</span>&nbsp;parse_shell_options&nbsp;<span class=operator>(</span><span class=operator>)</span><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;files,&nbsp;kwarg&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>{</span><span class=operator>}</span>,&nbsp;nil<br>&nbsp;&nbsp;<span class=keyword>for</span>&nbsp;i,word&nbsp;<span class=keyword>in</span>&nbsp;ipairs<span class=operator>(</span>arg<span class=operator>)</span>&nbsp;<span class=keyword>do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;kwarg&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;kwarg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"d"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outputdir&nbsp;<span class=operator>=</span>&nbsp;word<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>elseif</span>&nbsp;kwarg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"-lift"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;liftfile&nbsp;<span class=operator>=</span>&nbsp;word<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files<span class=operator>[</span><span class=operator>#</span>files+1<span class=operator>]</span>&nbsp;<span class=operator>=</span>&nbsp;word<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg&nbsp;<span class=operator>=</span>&nbsp;nil<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;word:sub<span class=operator>(</span>1,1<span class=operator>)</span>&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"-"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg&nbsp;<span class=operator>=</span>&nbsp;word:sub<span class=operator>(</span>2<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;kwarg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"h"</span>&nbsp;or&nbsp;kwarg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"v"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"ERROR: option <span class=string>'" .. kwarg .. "'</span> has to be the only option."</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;<span class=operator>{</span>err<span class=operator>=</span>true<span class=operator>}</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>elseif</span>&nbsp;kwarg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"d"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>elseif</span>&nbsp;kwarg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"-lift"</span>&nbsp;<span class=keyword>then</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"WARNING: ignoring unkown argument -"</span>&nbsp;..&nbsp;kwarg<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"Please help yourself by typing <span class=string>'docl.lua -h'</span>"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files<span class=operator>[</span><span class=operator>#</span>files+1<span class=operator>]</span>&nbsp;<span class=operator>=</span>&nbsp;word<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;<span class=keyword>end</span><br><br>&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;outputdir&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;nil&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"WARNING: missing option <span class=string>'-d'</span>, default is <span class=string>'-d doc'</span>"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;outputdir&nbsp;<span class=operator>=</span>&nbsp;<span class=string>"doc"</span><br>&nbsp;&nbsp;<span class=keyword>end</span><br><br>&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;not&nbsp;does_directory_exist<span class=operator>(</span>outputdir<span class=operator>)</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;<span class=operator>{</span>err<span class=operator>=</span>true<span class=operator>}</span><br>&nbsp;&nbsp;<span class=keyword>end</span><br><br>&nbsp;&nbsp;outputdir&nbsp;<span class=operator>=</span>&nbsp;outputdir&nbsp;..&nbsp;<span class=string>"/"</span><br>&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;<span class=operator>{</span>outputdir<span class=operator>=</span>outputdir,&nbsp;files<span class=operator>=</span>files<span class=operator>}</span><br><span class=keyword>end</span><br><br><br><br><span class=keyword>if</span>&nbsp;<span class=operator>#</span>arg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;0&nbsp;or&nbsp;arg<span class=operator>[</span>1<span class=operator>]</span>&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"-h"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;print<span class=operator>(</span>help<span class=operator>)</span><br><br><span class=keyword>elseif</span>&nbsp;<span class=operator>#</span>arg&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;0&nbsp;or&nbsp;arg<span class=operator>[</span>1<span class=operator>]</span>&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;<span class=string>"-v"</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"This docl version 1.1 - have fun!"</span><span class=operator>)</span><br><br><span class=keyword>else</span><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;docldir,&nbsp;file&nbsp;<span class=operator>=</span>&nbsp;arg<span class=operator>[</span>0<span class=operator>]</span>:match<span class=string>'(.*/)(.*)'</span><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;outputdir&nbsp;<span class=operator>=</span>&nbsp;nil<br><br>&nbsp;&nbsp;package.path&nbsp;<span class=operator>=</span>&nbsp;docldir&nbsp;..&nbsp;<span class=string>"?.lua;"</span>&nbsp;..&nbsp;package.path<br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;doc&nbsp;<span class=operator>=</span>&nbsp;require&nbsp;<span class=string>"doc"</span><br><br>&nbsp;&nbsp;<span class=comment>-- parse shell options and arguments</span><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;options&nbsp;<span class=operator>=</span>&nbsp;parse_shell_options<span class=operator>(</span><span class=operator>)</span><br><br>&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;links&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>{</span><span class=operator>}</span><br><br>&nbsp;&nbsp;<span class=comment>-- do your thing</span><br>&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;not&nbsp;options.err&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;toc&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>{</span><span class=operator>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>for</span>&nbsp;i,file&nbsp;<span class=keyword>in</span>&nbsp;ipairs<span class=operator>(</span>options.files<span class=operator>)</span>&nbsp;<span class=keyword>do</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"gen_file "</span>&nbsp;..&nbsp;file<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sections&nbsp;<span class=operator>=</span>&nbsp;doc.parse_file<span class=operator>(</span>file,&nbsp;links<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;<span class=operator>=</span>&nbsp;doc.gen_file<span class=operator>(</span>sections<span class=operator>)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;file&nbsp;<span class=operator>=</span><span class=operator>=</span>&nbsp;liftfile&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theliftfile&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>{</span>sections<span class=operator>=</span>sections,&nbsp;result<span class=operator>=</span>result<span class=operator>}</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>elseif</span>&nbsp;result&nbsp;~<span class=operator>=</span>&nbsp;false&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;output&nbsp;<span class=operator>=</span>&nbsp;file:gsub<span class=operator>(</span><span class=string>"/"</span>,&nbsp;<span class=string>"."</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;f&nbsp;<span class=operator>=</span>&nbsp;io.open<span class=operator>(</span>options.outputdir&nbsp;..&nbsp;output&nbsp;..&nbsp;<span class=string>".html"</span>,&nbsp;<span class=string>"w"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f:write<span class=operator>(</span>result<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f:close<span class=operator>(</span><span class=operator>)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table.insert<span class=operator>(</span>toc,&nbsp;<span class=operator>{</span><span class=string>"&lt;a href=<span class=string>'" .. output .. ".html'</span>>"</span>&nbsp;..&nbsp;output&nbsp;..&nbsp;<span class=string>"&lt;/a>"</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sections<span class=operator>[</span>1<span class=operator>]</span>.first&nbsp;and&nbsp;sections<span class=operator>[</span>1<span class=operator>]</span>.first.first&nbsp;or&nbsp;<span class=string>""</span><span class=operator>}</span><span class=operator>)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"  NO DOCS FOR "</span>&nbsp;..&nbsp;file<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;content,&nbsp;navigation&nbsp;<span class=operator>=</span>&nbsp;<span class=string>""</span>,&nbsp;<span class=string>""</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;theliftfile&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>for</span>&nbsp;i,&nbsp;section&nbsp;<span class=keyword>in</span>&nbsp;ipairs<span class=operator>(</span>theliftfile.sections<span class=operator>)</span>&nbsp;<span class=keyword>do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;description&nbsp;<span class=operator>=</span>&nbsp;theliftfile.sections<span class=operator>[</span>i<span class=operator>]</span>.first&nbsp;or&nbsp;<span class=operator>{</span><span class=operator>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;title&nbsp;<span class=operator>=</span>&nbsp;description.first<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;<span class=keyword>function</span>&nbsp;content_template<span class=operator>(</span>section<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;doc.wrap<span class=operator>(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table.concat<span class=operator>(</span>doc.map<span class=operator>(</span>section,&nbsp;function<span class=operator>(</span>def<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;doc.def_template<span class=operator>(</span>def.first,&nbsp;<span class=string>"&lt;p>"</span>..table.concat<span class=operator>(</span>def,&nbsp;<span class=string>"\n"</span><span class=operator>)</span>:gsub<span class=operator>(</span><span class=string>"\n\n"</span>,&nbsp;<span class=string>"&lt;/p>&lt;p>"</span><span class=operator>)</span>..<span class=string>"&lt;/p>"</span>&nbsp;<span class=operator>)</span>&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=operator>)</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;<span class=string>"dl"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;<span class=keyword>function</span>&nbsp;nav_template<span class=operator>(</span>section<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;doc.wraps<span class=operator>(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.map<span class=operator>(</span>section,&nbsp;function<span class=operator>(</span>x<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>return</span>&nbsp;<span class=string>"&lt;a href=#"</span>&nbsp;..&nbsp;x.first:sub<span class=operator>(</span>1,&nbsp;<span class=operator>(</span>x.first:find<span class=operator>(</span><span class=string>" "</span><span class=operator>)</span>&nbsp;or&nbsp;1<span class=operator>)</span>-1<span class=operator>)</span>&nbsp;..&nbsp;<span class=string>">"</span>&nbsp;..&nbsp;x.first&nbsp;..&nbsp;<span class=string>"&lt;/a>"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;<span class=string>"li"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;<span class=operator>=</span>&nbsp;content<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;doc.wrap<span class=operator>(</span>title,&nbsp;i<span class=operator>=</span><span class=operator>=</span>1&nbsp;and&nbsp;<span class=string>"h1"</span>&nbsp;or&nbsp;<span class=string>"h2"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;<span class=string>"&lt;p>"</span>..table.concat<span class=operator>(</span>description,&nbsp;<span class=string>"\n"</span><span class=operator>)</span>:gsub<span class=operator>(</span><span class=string>"\n\n"</span>,&nbsp;<span class=string>"&lt;/p>&lt;p>"</span><span class=operator>)</span>..<span class=string>"&lt;p>"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;content_template<span class=operator>(</span>section<span class=operator>)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;navigation&nbsp;<span class=operator>=</span>&nbsp;navigation<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;doc.wrap<span class=operator>(</span>title,&nbsp;i<span class=operator>=</span><span class=operator>=</span>1&nbsp;and&nbsp;<span class=string>"h2"</span>&nbsp;or&nbsp;<span class=string>"h3"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;nav_template<span class=operator>(</span>section<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;<span class=operator>=</span>&nbsp;content&nbsp;..&nbsp;doc.wrap<span class=operator>(</span>liftfile&nbsp;and&nbsp;<span class=string>"Modules"</span>&nbsp;or&nbsp;<span class=string>"Content"</span>,&nbsp;<span class=string>"h2"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;<span class=string>"&lt;table>&lt;/body>"</span>&nbsp;..&nbsp;doc.wraps<span class=operator>(</span>doc.map<span class=operator>(</span>toc,&nbsp;<span class=keyword>function</span>&nbsp;<span class=operator>(</span>x<span class=operator>)</span>&nbsp;<span class=keyword>return</span>&nbsp;doc.wraps<span class=operator>(</span>x,&nbsp;<span class=string>"td"</span><span class=operator>)</span>&nbsp;end<span class=operator>)</span>,&nbsp;<span class=string>"tr"</span><span class=operator>)</span>&nbsp;..&nbsp;<span class=string>"&lt;/tbody>&lt;/table>"</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;navigation&nbsp;<span class=operator>=</span>&nbsp;navigation&nbsp;..&nbsp;doc.wrap<span class=operator>(</span>liftfile&nbsp;and&nbsp;<span class=string>"Modules"</span>&nbsp;or&nbsp;<span class=string>"Content"</span>,&nbsp;<span class=string>"h2"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;<span class=string>"&lt;ul id=main-list>"</span>&nbsp;..&nbsp;doc.wraps<span class=operator>(</span>doc.map<span class=operator>(</span>toc,&nbsp;<span class=keyword>function</span>&nbsp;<span class=operator>(</span>x<span class=operator>)</span>&nbsp;<span class=keyword>return</span>&nbsp;x<span class=operator>[</span>1<span class=operator>]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;<span class=string>"&lt;div style=<span class=string>'margin: 0 1em 1em; font-size: .9em;'</span>>"</span>&nbsp;..&nbsp;x<span class=operator>[</span>2<span class=operator>]</span>&nbsp;..&nbsp;<span class=string>"&lt;/div>"</span>&nbsp;end<span class=operator>)</span>,&nbsp;<span class=string>"li"</span><span class=operator>)</span>&nbsp;..&nbsp;<span class=string>"&lt;/ul>"</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;file&nbsp;<span class=operator>=</span>&nbsp;io.open<span class=operator>(</span>options.outputdir&nbsp;..&nbsp;<span class=string>"index.html"</span>,&nbsp;<span class=string>"w"</span><span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file:write<span class=operator>(</span>&nbsp;doc.file_template<span class=operator>(</span>content,&nbsp;navigation<span class=operator>)</span>&nbsp;<span class=operator>)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file:close<span class=operator>(</span><span class=operator>)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;filestable&nbsp;<span class=operator>=</span>&nbsp;<span class=operator>{</span><span class=operator>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>for</span>&nbsp;i,e2&nbsp;<span class=keyword>in</span>&nbsp;ipairs<span class=operator>(</span>options.files<span class=operator>)</span>&nbsp;<span class=keyword>do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filestable<span class=operator>[</span>e2:gsub<span class=operator>(</span><span class=string>"/"</span>,&nbsp;<span class=string>"."</span><span class=operator>)</span><span class=operator>]</span>&nbsp;<span class=operator>=</span>&nbsp;true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>for</span>&nbsp;i,e&nbsp;<span class=keyword>in</span>&nbsp;ipairs<span class=operator>(</span>links<span class=operator>)</span>&nbsp;<span class=keyword>do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>local</span>&nbsp;url,&nbsp;hash&nbsp;<span class=operator>=</span>&nbsp;e.url:match<span class=string>'(.*)%.html#(.*)'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>if</span>&nbsp;not&nbsp;filestable<span class=operator>[</span>url<span class=operator>]</span>&nbsp;<span class=keyword>then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class=operator>(</span><span class=string>"ERROR in File "</span>&nbsp;..&nbsp;e.file&nbsp;..&nbsp;<span class=string>" in line "</span>&nbsp;..&nbsp;e.line&nbsp;..&nbsp;<span class=string>": "</span>&nbsp;..&nbsp;url&nbsp;..&nbsp;<span class=string>"#"</span>&nbsp;..&nbsp;hash<span class=operator>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;<span class=keyword>end</span><br>&nbsp;&nbsp;<br><span class=keyword>end</span><br></pre></div></div><p><dl><dt id=><a href=#> Usage</a></dt>
<dd><p> <code><span class=string>"docl [-v] [-h] [-d OUTPUTDIR] [--lift LIFTFILE] FILES"</span></code></p><p> Generate the documentation files. Creates files at
 <code>OUTPUTDIR<span class=operator>/</span>path.to.file.html</code> for every specified file and <code>index.html</code>
 file, containing a summary.</p><p> For example the documentation of <code>src<span class=operator>/</span>plugins<span class=operator>/</span>vector.lua</code> would be placed
 at <code>docs<span class=operator>/</span>src.plugins.vector.lua.html</code>.</p><p> The default OUTPUTDIR is <code>doc</code>.</p><p></p></dd><dt id=><a href=#> Options</a></dt>
<dd><p> <code><span class=string>"-v"</span></code>
    show version number</p><p> <code><span class=string>"-h"</span></code>
    show a short help</p><p> <code><span class=string>"-d OUTPUTDIR"</span></code></p><p>    specify a directory for the html documentation files.
    default is <code>doc</code></p><p> <code><span class=string>"--lift LIFTFILE"</span></code></p><p>    "lift" a specific file. eg. show its documentation on the index page.
    you probably want to do that with the main file.</p><p></p></dd><dt id=><a href=#> Note</a></dt>
<dd><p>  docl names the documentation of files relative to the working directory.</p><p>  if all files to be documented are inside a specific directory, you
  should <code>cd</code> (change-directory) there, before invoking <code>docl</code>.</p><p>  For example if you are at <code><span class=operator>/</span>home<span class=operator>/</span>james<span class=operator>/</span></code> and you call</p><p>    <code>docl&nbsp;my-programs<span class=operator>/</span>my-app<span class=operator>/</span>src<span class=operator>/</span>lua<span class=operator>/</span>*.lua</code></p><p>  then docl will name the output files <code>my-programs.my-app.src.lua.*.lua.html</code>
  (which is pretty dumb).</p><p>  if you want them to be called only *.lua.html simply <code>cd</code> (change the
  directory) before invoking docl.</p><p>    <code>cd&nbsp;<span class=operator>/</span>home<span class=operator>/</span>james<span class=operator>/</span>my-programs<span class=operator>/</span>my-app<span class=operator>/</span>src<span class=operator>/</span>lua;&nbsp;docl&nbsp;*.lua</code></p><p>  then docl will name the output files <code>*.lua.html</code> which is much better.
</p></dd><dt id=><a href=#> Examples</a></dt>
<dd><p> Here are some usage examples:</p><p> <code>.<span class=operator>/</span>docl&nbsp;*.lua</code></p><p> document all .lua files in this directory</p><p> <code>.<span class=operator>/</span>docl&nbsp;*.lua&nbsp;*<span class=operator>/</span>*.lua</code></p><p> document all .lua files in this directory and all subdirectories
 (but not recursive!)</p><p> <code>.<span class=operator>/</span>docl&nbsp;-d&nbsp;html-doc&nbsp;$$<span class=operator>(</span><span class=operator>(</span>find&nbsp;-name&nbsp;<span class=string>"*.lua"</span><span class=operator>)</span><span class=operator>)</span></code></p><p> recursively document all files ending in .lua and put output into <code>html-doc<span class=operator>/</span></code>
</p></dd></dl><h2>Modules</h2><table></body><tr><td><a href='doc.lua.html'>doc.lua</a></td><td> helper functions</td></tr><tr><td><a href='highlight.lua.html'>highlight.lua</a></td><td> Simple Syntax Highlighting</td></tr><tr><td><a href='repr.lua.html'>repr.lua</a></td><td> Readable tostring</td></tr></tbody></table>
  </div><div id=navigation>
<h2> docl</h2><li><a href=#> Usage</a></li><li><a href=#> Options</a></li><li><a href=#> Note</a></li><li><a href=#> Examples</a></li><h2>Modules</h2><ul id=main-list><li><a href='doc.lua.html'>doc.lua</a><div style='margin: 0 1em 1em; font-size: .9em;'> helper functions</div></li><li><a href='highlight.lua.html'>highlight.lua</a><div style='margin: 0 1em 1em; font-size: .9em;'> Simple Syntax Highlighting</div></li><li><a href='repr.lua.html'>repr.lua</a><div style='margin: 0 1em 1em; font-size: .9em;'> Readable tostring</div></li></ul>
  </div><footer style=margin-right>
    generated with docl
  </footer></body></html>